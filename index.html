<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Pokedex</title>

    <link rel="stylesheet" href="assets/bootstrap-3.3.6/css/bootstrap.min.css">

    <style type="text/css">
        h1 {
            text-align: center;
            font-size: 48px;
        }
        
        h4 {
            text-align: center;
        }
        
        .thumbnail.list {
            height: 200px;
            position: relative;
            overflow: hidden;
        }
        
        .thumbnail.list:hover {
            cursor: pointer;
            background-color: rgba(75, 75, 75, 0.1);
            border: 2px solid #777;
        }
        
        .thumbnail.details {
            height: 525px;
            width: 250px;
        }
        
        #pockemonLoadBtn {
            width: 100%;
        }
        
        #loadButtonPanel {
            display: none;
        }
        
        #loadingMain {
            position: absolute;
            background: white url('img/loading.gif') no-repeat center center;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 20001;
        }
        
        #loadingButton {
            display: none;
        }
       
    </style>

    <script type="text/javascript" src="assets/jquery.min.js"></script>
    <script type="text/javascript" src="assets/bootstrap-3.3.6/js/bootstrap.min.js"></script>

</head>

<body>

    <div class="container">
        <div class="page-header">
            <h1>Pokedex</h1>
        </div>

        <div id="loadingMain" class="affix"></div>

        <div class="row">
            <div class="col-md-9">
                <div id="dataList" class="row">
                    <!-- Pokemon list -->
                </div>
                <div id="loadButtonPanel">
                    <button id="pockemonLoadBtn" class="btn btn-default"><span id=loadingButton><img src="img/loading.gif" height="20"></span> LOAD MORE</button>
                    <hr/>
                </div>
            </div>

            <div class="col-md-3" id="pokemonDetails">
                <!-- Pokemon details -->
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {

            var url = 'http://pokeapi.co/api/v1/pokemon/?limit=12';

            function loadData() {
                $.ajax({
                    type: "GET",
                    url: url,
                    dataType: "json",
                    success: function(data) {
                        url = 'http://pokeapi.co' + data.meta.next;

                        $.each(data.objects, function(index, pdata) {

                            var pockemonName = pdata.name;
                            var pockemonId = pdata.pkdx_id;
                            var pockemonImage = pdata.pkdx_id;

                            // get pockemonType data
                            var ptypeArray = [];
                            $.each(pdata.types, function(index, ptype) { 
                                var typeElement = '<a href="#" class="btn btn-default btn-xs">' + ptype.name + '</a>&nbsp;';
                                ptypeArray.push(typeElement);

                            });
                            
                            ptypeArray.sort();
                            var pockemonType = ptypeArray.join('');

                            var content = '<div class="col-xs-4">' +
                                '<div class="thumbnail list" data-id="' + pockemonId + '">' +
                                '<a href="#" class="">' +
                                '<img src="http://pokeapi.co/media/img/' + pockemonId + '.png" height="120" width="120" alt="Pockemon" class="">' +
                                '<div class="caption">' +
                                '<h4 class="">' + pockemonName + '</h4>' +
                                '<p class="">' + pockemonType + '</p>' +
                                '</div>' +
                                '</a>' +
                                '</div>' +
                                '</div>';

                            $('#dataList').append(content);

                        });

                        //display load button
                        $('#loadButtonPanel').css("display", "block");
                        $('#loadingMain').hide();
                        $('#loadingButton').css("display", "none");
                        document.getElementById('loadButtonPanel').scrollIntoView();
                    }
                });
            };


            $('body').delegate('.thumbnail.list', 'click', function(e) {
                e.preventDefault();

                $('.thumbnail.list').css("border", "1px solid #ddd"); // reset border style to default
                $(this).css("border", "2px solid #777"); // set custom border style

                var dataPockemonId = $(this).data('id');

                $.ajax({
                    type: 'GET',
                    url: 'http://pokeapi.co/api/v1/pokemon/' + dataPockemonId + '/',
                    success: function(pockemonData) {

                        var pokemonData = '<div class="thumbnail details affix">' +
                            '<img src="http://pokeapi.co/media/img/' + dataPockemonId + '.png" height="120" width="120" alt="Pockemon">' +
                            '<div class="caption">' +
                            '<h4>' + pockemonData.name + ' #' + dataPockemonId + '</h4>' +
                            '<table class="table table-bordered">' +
                            '<thead>' +
                            '<tr>' +
                            '<th>Type</th>' +
                            '<th>Fire</th>' +
                            '</tr>' +
                            '</thead>' +
                            '<tbody>' +
                            '<tr>' +
                            '<td>Attack</td>' +
                            '<td>' + pockemonData.attack + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Defense</td>' +
                            '<td>' + pockemonData.defense + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>HP</td>' +
                            '<td>' + pockemonData.hp + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>SP Attack</td>' +
                            '<td>' + pockemonData.sp_atk + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>SP Defense</td>' +
                            '<td>' + pockemonData.sp_def + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Speed</td>' +
                            '<td>' + pockemonData.speed + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Weight</td>' +
                            '<td>' + pockemonData.weight + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Total moves</td>' +
                            '<td>' + pockemonData.moves.length + '</td>' +
                            '</tr>' +
                            '</tbody>' +
                            '</table>' +
                            '</div>' +
                            '</div>';

                        $(".thumbnail.details").remove(); // remove previous pokemon detail information
                        $('#pokemonDetails').append(pokemonData);
                    }
                });
            });

            // Load More
            $('#pockemonLoadBtn').on('click', function() {
                $('#loadingButton').css("display", "block");
                loadData();
            });

            loadData();
            
        });
    </script>
</body>

</html>